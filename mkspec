#!/usr/bin/env bash

prod_filepath="$1"
prod_filename=`basename $prod_filepath`

path=`dirname $prod_filepath`

filename="${prod_filename%%.*}"
extension=".${prod_filename#*.}"
if [ "$prod_filename" != "$filename$extension" ]; then
  extension=''
fi

spec_filename="${filename}_spec${extension}"

spec_path=spec/${path#app/}

mkdir -p $path
mkdir -p $spec_path
touch $path/$prod_filename

if [ "$extension" ]; then
  support_dir=`dirname $0`/support/mkspec
  rb_spec=$support_dir/spec.rb
  cp $rb_spec $spec_path/$spec_filename
else
  touch $spec_path/$spec_filename
fi
